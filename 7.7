/* comment
*/
#include <stdio.h>
#include <stdlib.h>
#define maxvals 1000

void selection_sorti(int A[], int n);
void int_swap(int *p1, int *p2);
int maxfreq(int A[], int n);
int maxfreq1(int A[], int n);

int
main(int argc, char *argv[]) {
	int n, excess, A[maxvals], x, nextnumber;
	printf("Enter as many as %d values, ^D to end\n", maxvals);
	n=0; excess=0;
	while (scanf("%d", &nextnumber)==1){
		if (n==maxvals) {
			excess = excess+1;
		}else{		
			A[n] = nextnumber;
			n+=1;
		}/*n values in array*/
	}printf("%d values read into array\n", n);
	}x=maxfreq1(A,n);
	printf("%d", x);
	return 0;
}


void 
selection_sorti(int A[], int n){
	int maxval, maxpos, i, j;
	for (i=0; i<n; i++){
		maxval=A[0]; maxpos=0;
		for(j=0; j<n-i; j++){
			if (A[j]>maxval){
				maxval=A[j];
				maxpos=j;
			}
		}int_swap(&A[maxpos], &A[n-i-1]);
	}
}

int
maxfreq(int A[], int n){
	/*requires sorted array*/
	int i, x, maxfreq, maxfreqval;
	maxfreq=0;
	for(i=0; i<n;){
		for(x=1;A[x+i]==A[i];x++){
		}if (x>=maxfreq){
			if ((x>maxfreq) || ((x==maxfreq) && (A[i]<maxfreqval))){
				maxfreqval=A[i];
				maxfreq=x;
			}
		}i+=x;
	}return maxfreqval;
}

int 
maxfreq1(int A[], int n){
	int B[maxvals]={0};
	int C[maxvals]={0};
	int i, distinct, j, maxfreq, maxindex;
	distinct=0;
	for (i=0; i<n; i++){
		for (j=0; A[i]!=B[j]&&j<distinct;j++){
		}if (j==distinct){
			B[j]=A[i];
			distinct+=1;
			C[j]+=1;
		}else { /*A[i]==B[j]*/
			C[j]+=1;
		}
	}
	maxfreq=C[0];
	maxindex=0;
	for (i=1; i<distinct; i++){
		if (C[i]>maxfreq){
			maxfreq=C[i];
			maxindex=i;
		}
		else if (C[i]==maxfreq && B[i]<B[maxindex]){
			maxfreq=C[i];
			maxindex=i;
		}
	}return B[maxindex];
}
	

void 
int_swap(int *p1, int *p2){
	int temp=0;
	temp=*p1;
	*p1=*p2;
	*p2=temp;
}
			
